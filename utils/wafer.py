import matplotlib.patches as mpatches
import matplotlib.colors as colors
from matplotlib.collections import PatchCollection
import matplotlib.pyplot as plt
import numpy as np

# trigger cell coordinates for drawing
coords = np.array([[[ 7.30715907, 17.77361044],
        [ 7.30715907, 15.42983385],
        [ 9.33692493, 14.25794556],
        [ 9.33692493, 16.60172215]],
       [[ 7.30715907, 15.37123944],
        [ 7.30715907, 13.02746285],
        [ 9.33692493, 11.85557456],
        [ 9.33692493, 14.19935115]],
       [[ 7.30715907, 12.96887294],
        [ 7.30715907, 10.62509635],
        [ 9.33692493,  9.45320806],
        [ 9.33692493, 11.79698465]],
       [[ 7.30715907, 10.56650644],
        [ 7.30715907,  8.22272985],
        [ 9.33692493,  7.05084156],
        [ 9.33692493,  9.39461815]],
       [[ 9.38766907, 16.57242244],
        [ 9.38766907, 14.22864585],
        [11.41743493, 13.05675756],
        [11.41743493, 15.40053415]],
       [[ 9.38766907, 14.17005644],
        [ 9.38766907, 11.82627985],
        [11.41743493, 10.65439156],
        [11.41743493, 12.99816815]],
       [[ 9.38766907, 11.76768944],
        [ 9.38766907,  9.42391285],
        [11.41743493,  8.25202456],
        [11.41743493, 10.59580115]],
       [[ 9.38766907,  9.36531914],
        [ 9.38766907,  7.02154255],
        [11.41743493,  5.84965426],
        [11.41743493,  8.19343085]],
       [[11.46817807, 15.37123944],
        [11.46817807, 13.02746285],
        [13.49794393, 11.85557456],
        [13.49794393, 14.19935115]],
       [[11.46817807, 12.96887294],
        [11.46817807, 10.62509635],
        [13.49794393,  9.45320806],
        [13.49794393, 11.79698465]],
       [[11.46817807, 10.56650644],
        [11.46817807,  8.22272985],
        [13.49794393,  7.05084156],
        [13.49794393,  9.39461815]],
       [[11.46817807,  8.16414344],
        [11.46817807,  5.82036685],
        [13.49794393,  4.64847856],
        [13.49794393,  6.99225515]],
       [[13.54868707, 14.17005644],
        [13.54868707, 11.82627985],
        [15.57845293, 10.65439156],
        [15.57845293, 12.99816815]],
       [[13.54868707, 11.76768944],
        [13.54868707,  9.42391285],
        [15.57845293,  8.25202456],
        [15.57845293, 10.59580115]],
       [[13.54868707,  9.36531914],
        [13.54868707,  7.02154255],
        [15.57845293,  5.84965426],
        [15.57845293,  8.19343085]],
       [[13.54868707,  6.96295644],
        [13.54868707,  4.61917985],
        [15.57845293,  3.44729156],
        [15.57845293,  5.79106815]],
       [[-1.01488293,  3.44728586],
        [-1.01488293,  5.79106245],
        [ 1.01488293,  6.96295074],
        [ 1.01488293,  4.61917415]],
       [[ 1.06563007,  4.64846926],
        [ 1.06563007,  6.99224585],
        [ 3.09539593,  8.16413414],
        [ 3.09539593,  5.82035755]],
       [[ 3.14613907,  5.84965256],
        [ 3.14613907,  8.19342915],
        [ 5.17590493,  9.36531744],
        [ 5.17590493,  7.02154085]],
       [[ 5.22664847,  7.05083206],
        [ 5.22664847,  9.39460865],
        [ 7.25641433, 10.56649694],
        [ 7.25641433,  8.22272035]],
       [[-1.01488293,  5.84965256],
        [-1.01488293,  8.19342915],
        [ 1.01488293,  9.36531744],
        [ 1.01488293,  7.02154085]],
       [[ 1.06563007,  7.05083206],
        [ 1.06563007,  9.39460865],
        [ 3.09539593, 10.56649694],
        [ 3.09539593,  8.22272035]],
       [[ 3.14613907,  8.25201956],
        [ 3.14613907, 10.59579615],
        [ 5.17590493, 11.76768444],
        [ 5.17590493,  9.42390785]],
       [[ 5.22664847,  9.45320256],
        [ 5.22664847, 11.79697915],
        [ 7.25641433, 12.96886744],
        [ 7.25641433, 10.62509085]],
       [[-1.01488293,  8.25201956],
        [-1.01488293, 10.59579615],
        [ 1.01488293, 11.76768444],
        [ 1.01488293,  9.42390785]],
       [[ 1.06563007,  9.45320256],
        [ 1.06563007, 11.79697915],
        [ 3.09539593, 12.96886744],
        [ 3.09539593, 10.62509085]],
       [[ 3.14613907, 10.65438156],
        [ 3.14613907, 12.99815815],
        [ 5.17590493, 14.17004644],
        [ 5.17590493, 11.82626985]],
       [[ 5.22664847, 11.85556956],
        [ 5.22664847, 14.19934615],
        [ 7.25641433, 15.37123444],
        [ 7.25641433, 13.02745785]],
       [[-1.01488293, 10.65438156],
        [-1.01488293, 12.99815815],
        [ 1.01488293, 14.17004644],
        [ 1.01488293, 11.82626985]],
       [[ 1.06563007, 11.85556956],
        [ 1.06563007, 14.19934615],
        [ 3.09539593, 15.37123444],
        [ 3.09539593, 13.02745785]],
       [[ 3.14613907, 13.05675256],
        [ 3.14613907, 15.40052915],
        [ 5.17590493, 16.57241744],
        [ 5.17590493, 14.22864085]],
       [[ 5.22664847, 14.25793556],
        [ 5.22664847, 16.60171215],
        [ 7.25641433, 17.77360044],
        [ 7.25641433, 15.42982385]],
       [[11.49354415,  3.4135461 ],
        [13.52331   ,  4.58543439],
        [15.55307585,  3.4135461 ],
        [13.52331   ,  2.24165781]],
       [[ 9.41303315,  4.6147295 ],
        [11.442799  ,  5.78661779],
        [13.47256485,  4.6147295 ],
        [11.442799  ,  3.44284121]],
       [[ 7.33252415,  5.815913  ],
        [ 9.36229   ,  6.98780129],
        [11.39205585,  5.815913  ],
        [ 9.36229   ,  4.64402471]],
       [[ 5.25201485,  7.017096  ],
        [ 7.2817807 ,  8.18898429],
        [ 9.31154655,  7.017096  ],
        [ 7.2817807 ,  5.84520771]],
       [[ 9.41303315,  2.2123628 ],
        [11.442799  ,  3.38425109],
        [13.47256485,  2.2123628 ],
        [11.442799  ,  1.04047451]],
       [[ 7.33252415,  3.4135461 ],
        [ 9.36229   ,  4.58543439],
        [11.39205585,  3.4135461 ],
        [ 9.36229   ,  2.24165781]],
       [[ 5.25201485,  4.6147295 ],
        [ 7.2817807 ,  5.78661779],
        [ 9.31154655,  4.6147295 ],
        [ 7.2817807 ,  3.44284121]],
       [[ 3.17150375,  5.815913  ],
        [ 5.2012696 ,  6.98780129],
        [ 7.23103545,  5.815913  ],
        [ 5.2012696 ,  4.64402471]],
       [[ 7.33252415,  1.0111795 ],
        [ 9.36229   ,  2.18306779],
        [11.39205585,  1.0111795 ],
        [ 9.36229   , -0.16070879]],
       [[ 5.25201485,  2.2123628 ],
        [ 7.2817807 ,  3.38425109],
        [ 9.31154655,  2.2123628 ],
        [ 7.2817807 ,  1.04047451]],
       [[ 3.17150375,  3.4135461 ],
        [ 5.2012696 ,  4.58543439],
        [ 7.23103545,  3.4135461 ],
        [ 5.2012696 ,  2.24165781]],
       [[ 1.09099265,  4.6147295 ],
        [ 3.1207585 ,  5.78661779],
        [ 5.15052435,  4.6147295 ],
        [ 3.1207585 ,  3.44284121]],
       [[ 5.25201485, -0.19      ],
        [ 7.2817807 ,  0.98188829],
        [ 9.31154655, -0.19      ],
        [ 7.2817807 , -1.36188829]],
       [[ 3.17150375,  1.0111795 ],
        [ 5.2012696 ,  2.18306779],
        [ 7.23103545,  1.0111795 ],
        [ 5.2012696 , -0.16070879]],
       [[ 1.09099265,  2.2123628 ],
        [ 3.1207585 ,  3.38425109],
        [ 5.15052435,  2.2123628 ],
        [ 3.1207585 ,  1.04047451]],
       [[-0.98951845,  3.4135461 ],
        [ 1.0402474 ,  4.58543439],
        [ 3.07001325,  3.4135461 ],
        [ 1.0402474 ,  2.24165781]]])

#construct patches
patches = []
for coord in coords:
    patches.append(mpatches.Polygon(coord,True))
    
def plot_wafer(data, fig=None, ax=None, scale=None, log=False):
    if fig is None or ax is None:
        fig,ax =plt.subplots(1,1)
    if log:
        p = PatchCollection(patches,norm=colors.LogNorm())
    else:
        p = PatchCollection(patches)
    p.set_array(data)
    ax.add_collection(p)
        
    ax.set_ylim(-2,18)
    ax.set_xlim(-3,17)
    if not scale is None:
        p.set_clim(scale[0], scale[1])
    fig.colorbar(p, ax=ax)
